"use strict";let browsedMovies=[],favMovies=[];const movieList=document.querySelector(".js-list"),favList=document.querySelector(".js-fav"),btn=document.querySelector(".js-btn"),delButton=document.querySelector(".js-delete-all");function getMovie(){const e=document.querySelector(".js-input").value;fetch("//api.tvmaze.com/search/shows?q="+e).then((function(e){return e.json()})).then((function(e){browsedMovies=e,addListItem(),addListener()}))}function addListItem(){movieList.innerHTML="";for(let e=0;e<browsedMovies.length;e++){let t="";t+=`<li title="${browsedMovies[e].show.name}"`,t+='class="';const s=parseInt(browsedMovies[e].show.id);t+=void 0===favMovies.find(e=>e.show.id===s)?"":"selected ",t+=`js-movie js-movie${e} movie__list__item" id="${browsedMovies[e].show.id}">`,t+=`<img class="js-movie-img${e} movie__list__img" `,null===browsedMovies[e].show.image?t+='src= "https://via.placeholder.com/210x295/ffffff/666666/?text=Image"':t+="src = "+browsedMovies[e].show.image.medium,t+=` alt="${browsedMovies[e].show.name}" title="${browsedMovies[e].show.name}">`,t+=`<h3 class="movie__list__name">${browsedMovies[e].show.name}</h3>`,t+="</li>",movieList.innerHTML+=t}}function selectFavourite(e){const t=parseInt(e.currentTarget.id);if(void 0===favMovies.find(e=>e.show.id===t)){const e=browsedMovies.find(e=>e.show.id===t);favMovies.push(e),localStorage.setItem("movies",JSON.stringify(favMovies))}else{const e=favMovies.find(e=>e.show.id===t),s=favMovies.indexOf(e);favMovies.splice(s,1),localStorage.setItem("movies",JSON.stringify(favMovies))}addFavourite(),getMovie(),addListItem()}function addListener(){const e=document.querySelectorAll(".js-movie");for(const t of e)t.addEventListener("click",selectFavourite)}function addFavourite(){const e=document.querySelectorAll(".js-fav-item");for(const t of e)t.remove();for(let e=0;e<favMovies.length;e++){const t=document.createElement("li");t.classList.add("js-fav-item"),t.classList.add("js-fav"+e),t.classList.add("favourite__list__item");const s=document.createElement("img");t.appendChild(s),s.classList.add("js-fav-img"+e),s.classList.add("favourite__list__img"),s.setAttribute("alt",""+favMovies[e].show.name),s.setAttribute("title",""+favMovies[e].show.name),null===favMovies[e].show.image?s.src="https://via.placeholder.com/210x295/ffffff/666666/?text=Image":s.src=""+favMovies[e].show.image.medium;const i=document.createElement("h3");t.appendChild(i),i.classList.add("favourite__list__title");const o=document.createTextNode(""+favMovies[e].show.name);i.appendChild(o);const a=document.createElement("button");t.appendChild(a),a.setAttribute("id",""+favMovies[e].show.id),a.classList.add("favourite__list__btn"),a.classList.add("js-delete-btn"),a.setAttribute("title","Borrar");const d=document.createElement("i");a.appendChild(d),d.classList.add("favourite__list__fav"),d.classList.add("fas"),d.classList.add("fa-minus-circle"),favList.appendChild(t)}addRemoveListener()}function removeFavourite(e){const t=parseInt(e.currentTarget.id),s=favMovies.find(e=>e.show.id===t),i=favMovies.indexOf(s);favMovies.splice(i,1),localStorage.setItem("movies",JSON.stringify(favMovies)),e.preventDefault(),addFavourite(),getMovie(),addListItem()}function addRemoveListener(){const e=document.querySelectorAll(".js-delete-btn");for(const t of e)t.addEventListener("click",removeFavourite)}function deleteAll(e){favMovies=[],localStorage.clear(),e.preventDefault(),addFavourite(),getMovie()}function getMoviesFromLocal(){const e=JSON.parse(localStorage.getItem("movies"));null!==e?(favMovies=e,addFavourite()):favMovies=[]}getMoviesFromLocal(),btn.addEventListener("click",getMovie),delButton.addEventListener("click",deleteAll);